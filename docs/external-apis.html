<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì™¸ë¶€ API ì—°ë™ | ì²­ì•½í”Œë˜ë‹›</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <h1>ì™¸ë¶€ API ì—°ë™</h1>
      <p class="subtitle">ì™¸ë¶€ API ì—°ë™ ë¬¸ì„œ</p>
      <p class="description">ì²­ì•½í”Œë˜ë‹› ë°±ì—”ë“œ ê´€ë ¨ ë¬¸ì„œì…ë‹ˆë‹¤.</p>
    </header>

    <!-- Main Content -->
    <section class="content">
      <h2>ì™¸ë¶€ API í†µí•© ë¬¸ì„œ</h2>

      <article>
        <h3>ğŸŒ ê°œìš”</h3>
        <p>ì²­ì•½í”Œë˜ë‹›ì€ ì¢…í•©ì ì¸ ë¶€ë™ì‚° ì •ë³´ë¥¼ ì œê³µí•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ í•œêµ­ ì •ë¶€ ë° ìƒì—… APIì™€ í†µí•©ë©ë‹ˆë‹¤. ì´ ë¬¸ì„œëŠ” ëª¨ë“  ì™¸ë¶€ API í†µí•©, ëª©ì  ë° êµ¬í˜„ ì„¸ë¶€ ì •ë³´ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.</p>
      </article>

      <article>
        <h3>ğŸ›ï¸ ì •ë¶€ API</h3>

        <h4>1. í•œêµ­í† ì§€ì£¼íƒê³µì‚¬(LH) API</h4>

        <h5>ëª©ì </h5>
        <p>ì •ë¶€ ì£¼íƒ ê³µì‚¬ë¡œë¶€í„° í•œêµ­ ê³µê³µ ì£¼íƒ ì²­ì•½ ì •ë³´ë¥¼ ì§ì ‘ ê²€ìƒ‰í•©ë‹ˆë‹¤.</p>

        <h5>API ì„¸ë¶€ ì •ë³´</h5>
        <ul>
          <li><strong>ì œê³µì</strong>: í•œêµ­í† ì§€ì£¼íƒê³µì‚¬(LH)</li>
          <li><strong>ê¸°ë³¸ URL</strong>: <code>https://api.odcloud.kr/api/ApplyhomeInfoDetailSvc/v1</code></li>
          <li><strong>ì¸ì¦</strong>: ì„œë¹„ìŠ¤ í‚¤ (API í‚¤)</li>
          <li><strong>í˜¸ì¶œ ì œí•œ</strong>: 1ì¼ 1000ê±´</li>
          <li><strong>ë°ì´í„° í˜•ì‹</strong>: JSON</li>
        </ul>

        <h5>ì‚¬ìš©ëœ ì—”ë“œí¬ì¸íŠ¸</h5>
        <h6>ì•„íŒŒíŠ¸ ì²­ì•½ ì„¸ë¶€ ì •ë³´ ê°€ì ¸ì˜¤ê¸°</h6>
        <pre><code class="language-http">GET /getAPTLttotPblancDetail</code></pre>

        <h5>ë§¤ê°œë³€ìˆ˜</h5>
        <ul>
          <li><code>serviceKey</code>: API ì¸ì¦ í‚¤</li>
          <li><code>page</code>: í˜ì´ì§€ ë²ˆí˜¸ (ê¸°ë³¸ê°’: 1)</li>
          <li><code>perPage</code>: í˜ì´ì§€ë‹¹ ë ˆì½”ë“œ ìˆ˜ (ê¸°ë³¸ê°’: 50, ìµœëŒ€: 100)</li>
          <li><code>HOUSE_MANAGE_NO</code>: ì£¼íƒ ê´€ë¦¬ ë²ˆí˜¸ (ì„ íƒ ì‚¬í•­)</li>
          <li><code>PBLANC_NO</code>: ê³µê³  ë²ˆí˜¸ (ì„ íƒ ì‚¬í•­)</li>
        </ul>

        <h5>ì‘ë‹µ ì˜ˆì‹œ</h5>
        <pre><code class="language-json">{
  "currentCount": 1,
  "data": [
    {
      "HOUSE_MANAGE_NO": "2024000001",
      "PBLANC_NO": "2024ê°•ë‚¨01",
      "HOUSE_NM": "ë˜ë¯¸ì•ˆ ê°•ë‚¨í¬ë ˆìŠ¤íŠ¸",
      "HSSPLY_ADRES": "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ëŒ€ì¹˜ë™",
      "TOT_SUPLY_HSHLDCO": "100",
      "RCRIT_PBLANC_DE": "2024-06-19",
      "RCEPT_BGNDE": "2024-07-01",
      "RCEPT_ENDDE": "2024-07-03",
      "SPSPLY_RCEPT_BGNDE": "2024-06-25",
      "SPSPLY_RCEPT_ENDDE": "2024-06-27"
    }
  ],
  "matchCount": 1,
  "page": 1,
  "perPage": 50,
  "totalCount": 1
}</code></pre>

        <h5>êµ¬í˜„ ì„¸ë¶€ ì •ë³´</h5>
        <p><strong>ì„œë¹„ìŠ¤ í†µí•©:</strong></p>
        <pre><code class="language-java">@Service
public class SubscriptionService {

  @Value("${sub.apt.api.url}")
  private String subAptApiUrl;

  @Value("${sub.apt.api.key}")
  private String apiKey;

  public String updateSubAPT() {
    String requestUrl = subAptApiUrl + "?page=1&perPage=50&serviceKey=" + apiKey;
    try {
      ResponseEntity<String> response = restTemplate.exchange(
        requestUrl, HttpMethod.GET, null, String.class);
      processSubscriptionData(response.getBody());
    } catch (Exception e) {
      log.error("LH API í˜¸ì¶œ ì‹¤íŒ¨: {}", e.getMessage());
      return "API í˜¸ì¶œ ì‹¤íŒ¨: " + e.getMessage();
    }
    return "Success";
  }
}
</code></pre>

        <h5>ì˜¤ë¥˜ ì²˜ë¦¬</h5>
        <ul>
          <li>ë„¤íŠ¸ì›Œí¬ ì‹œê°„ ì´ˆê³¼: ì§€ìˆ˜ ë°±ì˜¤í”„ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¬ì‹œë„</li>
          <li>í˜¸ì¶œ ì œí•œ: ì‚¬ìš©ëŸ‰ ì¶”ì ì„ í†µí•´ ì¼ì¼ ì œí•œ ì¤€ìˆ˜</li>
          <li>ì˜ëª»ëœ ì‘ë‹µ: ë¬¸ì œì„± ë ˆì½”ë“œ ë¡œê¹… ë° ê±´ë„ˆë›°ê¸°</li>
          <li>ì¸ì¦ ì‹¤íŒ¨: ê´€ë¦¬ìì—ê²Œ ì•Œë¦¼</li>
        </ul>
      </article>

      <article>
        <h4>2. êµ­í† êµí†µë¶€ API</h4>

        <h5>ëª©ì </h5>
        <p>ì‹œì¥ ë¶„ì„ ë° ê°€ê²© ë¹„êµë¥¼ ìœ„í•œ ë¶€ë™ì‚° ê±°ë˜ ê°€ê²© ë°ì´í„° ê²€ìƒ‰</p>

        <h5>API ì„¸ë¶€ ì •ë³´</h5>
        <ul>
          <li><strong>ì œê³µì</strong>: êµ­í† êµí†µë¶€</li>
          <li><strong>ê¸°ë³¸ URL</strong>: <code>https://apis.data.go.kr/1613000/RTMSDataSvcAptTrade</code></li>
          <li><strong>ì¸ì¦</strong>: ì„œë¹„ìŠ¤ í‚¤</li>
          <li><strong>í˜¸ì¶œ ì œí•œ</strong>: 1ì¼ 1000ê±´</li>
          <li><strong>ë°ì´í„° í˜•ì‹</strong>: XML/JSON</li>
        </ul>

        <h5>ì‚¬ìš©ëœ ì—”ë“œí¬ì¸íŠ¸</h5>
        <h6>ì•„íŒŒíŠ¸ ê±°ë˜ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</h6>
        <pre><code class="language-http">GET /getRTMSDataSvcAptTrade</code></pre>

        <h5>ë§¤ê°œë³€ìˆ˜</h5>
        <ul>
          <li><code>serviceKey</code>: API ì¸ì¦ í‚¤</li>
          <li><code>LAWD_CD</code>: í–‰ì • êµ¬ì—­ ì½”ë“œ (ì‹œêµ°êµ¬ ì½”ë“œ)</li>
          <li><code>DEAL_YMD</code>: ê±°ë˜ ì—°ì›” (YYYYMM)</li>
          <li><code>numOfRows</code>: ë ˆì½”ë“œ ìˆ˜ (ê¸°ë³¸ê°’: 50)</li>
          <li><code>pageNo</code>: í˜ì´ì§€ ë²ˆí˜¸</li>
        </ul>

        <h5>ì‘ë‹µ ì˜ˆì‹œ</h5>
        <pre><code class="language-xml"><response>
  <body>
    <items>
      <item>
        <ê±°ë˜ê¸ˆì•¡>120,000</ê±°ë˜ê¸ˆì•¡>
        <ê±´ì¶•ë…„ë„>2020</ê±´ì¶•ë…„ë„>
        <ë…„>2024</ë…„>
        <ë²•ì •ë™>ëŒ€ì¹˜ë™</ë²•ì •ë™>
        <ì•„íŒŒíŠ¸>ë˜ë¯¸ì•ˆ</ì•„íŒŒíŠ¸>
        <ì›”>06</ì›”>
        <ì¼>15</ì¼>
        <ì „ìš©ë©´ì >84.93</ì „ìš©ë©´ì >
        <ì§€ë²ˆ>123-1</ì§€ë²ˆ>
        <ì¸µ>15</ì¸µ>
      </item>
    </items>
  </body>
</response></code></pre>

        <h5>êµ¬í˜„ ì„¸ë¶€ ì •ë³´</h5>
        <p><strong>ë¹„ë™ê¸° ì²˜ë¦¬:</strong></p>
        <pre><code class="language-java">@Async
@Retryable(value = Exception.class, maxAttempts = 3)
public CompletableFuture<Void> collectRealPriceData(String dealYMD) {
  List<SggCode> codes = sggCodeRepository.findAll();
  List<CompletableFuture<Void>> futures = codes.stream()
    .map(code -> CompletableFuture.runAsync(() ->
      processCodeData(code, dealYMD), taskExecutor))
    .collect(Collectors.toList());
  return CompletableFuture.allOf(futures.toArray(new CompletableFuture[0]));
}
</code></pre>
      </article>

      <article>
        <h3>ğŸ—ºï¸ ìƒì—… API</h3>

        <h4>3. ì¹´ì¹´ì˜¤ ì§€ë„ API</h4>

        <h5>ëª©ì </h5>
        <p>í•œêµ­ ì£¼ì†Œë¥¼ ì§€ë¦¬ì  ì¢Œí‘œë¡œ ë³€í™˜í•˜ê³  ìœ„ì¹˜ ê¸°ë°˜ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>

        <h5>API ì„¸ë¶€ ì •ë³´</h5>
        <ul>
          <li><strong>ì œê³µì</strong>: ì¹´ì¹´ì˜¤ ì£¼ì‹íšŒì‚¬</li>
          <li><strong>ê¸°ë³¸ URL</strong>: <code>https://dapi.kakao.com</code></li>
          <li><strong>ì¸ì¦</strong>: REST API í‚¤</li>
          <li><strong>í˜¸ì¶œ ì œí•œ</strong>: 1ì¼ 300,000ê±´</li>
          <li><strong>ë°ì´í„° í˜•ì‹</strong>: JSON</li>
        </ul>

        <h5>ì‚¬ìš©ëœ ì—”ë“œí¬ì¸íŠ¸</h5>
        <h6>ì£¼ì†Œ ê²€ìƒ‰ (ì§€ì˜¤ì½”ë”©)</h6>
        <pre><code class="language-http">GET /v2/local/search/address.json
Authorization: KakaoAK {REST_API_KEY}</code></pre>

        <h5>ë§¤ê°œë³€ìˆ˜</h5>
        <ul>
          <li><code>query</code>: ê²€ìƒ‰í•  ì£¼ì†Œ (í•œêµ­ì–´)</li>
          <li><code>analyze_type</code>: ë¶„ì„ ìœ í˜• (similar, exact)</li>
          <li><code>page</code>: í˜ì´ì§€ ë²ˆí˜¸</li>
          <li><code>size</code>: í˜ì´ì§€ë‹¹ ê²°ê³¼ ìˆ˜ (1-30)</li>
        </ul>

        <h5>ì‘ë‹µ ì˜ˆì‹œ</h5>
        <pre><code class="language-json">{
  "meta": {
    "total_count": 1,
    "pageable_count": 1,
    "is_end": true
  },
  "documents": [
    {
      "address_name": "ì„œìš¸ ê°•ë‚¨êµ¬ ëŒ€ì¹˜ë™ 944-32",
      "y": "37.494870",
      "x": "127.062583",
      "address_type": "REGION_ADDR",
      "address": {
        "region_1depth_name": "ì„œìš¸",
        "region_2depth_name": "ê°•ë‚¨êµ¬",
        "region_3depth_name": "ëŒ€ì¹˜ë™",
        "mountain_yn": "N",
        "main_address_no": "944",
        "sub_address_no": "32"
      }
    }
  ]
}</code></pre>

        <h5>êµ¬í˜„ ì„¸ë¶€ ì •ë³´</h5>
        <p><strong>WebClient ì„¤ì •:</strong></p>
        <pre><code class="language-java">@Configuration
public class WebClientConfig {

  @Value("${kakao.api.key}")
  private String kakaoApiKey;

  @Bean
  public WebClient kakaoWebClient() {
    return WebClient.builder()
      .baseUrl("https://dapi.kakao.com")
      .defaultHeader("Authorization", "KakaoAK " + kakaoApiKey)
      .codecs(configurer -> configurer.defaultCodecs().maxInMemorySize(1024 * 1024))
      .build();
  }
}
</code></pre>

        <p><strong>ì£¼ì†Œ ì§€ì˜¤ì½”ë”© ì„œë¹„ìŠ¤:</strong></p>
        <pre><code class="language-java">@Service
public class GeocodingService {

  private final WebClient webClient;

  public GeocodingService(WebClient kakaoWebClient) {
    this.webClient = kakaoWebClient;
  }

  public Mono<CoordinateResponseDTO> getCoordinates(String address) {
    return webClient.get()
      .uri(uriBuilder -> uriBuilder
        .path("/v2/local/search/address.json")
        .queryParam("query", address)
        .build())
      .retrieve()
      .bodyToMono(String.class)
      .map(this::parseCoordinates)
      .onErrorReturn(new CoordinateResponseDTO(null, null));
  }

  private CoordinateResponseDTO parseCoordinates(String jsonResponse) {
    try {
      JsonNode root = new ObjectMapper().readTree(jsonResponse);
      JsonNode document = root.path("documents").get(0);
      if (document != null) {
        double latitude = document.path("y").asDouble();
        double longitude = document.path("x").asDouble();
        return new CoordinateResponseDTO(latitude, longitude);
      }
    } catch (Exception e) {
      log.error("ì¢Œí‘œ íŒŒì‹± ì‹¤íŒ¨: {}", e.getMessage());
    }
    return new CoordinateResponseDTO(null, null);
  }
}
</code></pre>
      </article>

      <article>
        <h3>ğŸ”§ í†µí•© íŒ¨í„´</h3>

        <h4>1. ì¬ì‹œë„ ë©”ì»¤ë‹ˆì¦˜</h4>
        <pre><code class="language-java">@Retryable(
  value = {RestClientException.class, SocketTimeoutException.class},
  maxAttempts = 3,
  backoff = @Backoff(delay = 1000, multiplier = 2)
)
public String callExternalAPI(String url) {
  return restTemplate.getForObject(url, String.class);
}</code></pre>

        <h4>2. íšŒë¡œ ì°¨ë‹¨ê¸°</h4>
        <pre><code class="language-java">@Component
public class ExternalAPICircuitBreaker {

  private final RestTemplate restTemplate;
  private final CircuitBreaker circuitBreaker = CircuitBreaker.ofDefaults("externalAPI");

  public String callWithCircuitBreaker(String url) {
    return circuitBreaker.executeSupplier(() -> restTemplate.getForObject(url, String.class));
  }
}
</code></pre>

        <h4>3. í˜¸ì¶œ ì œí•œ</h4>
        <pre><code class="language-java">@Component
public class RateLimitedAPIClient {

  private final RestTemplate restTemplate;
  private final RateLimiter rateLimiter = RateLimiter.create(1.0);

  public String callAPI(String url) {
    rateLimiter.acquire();
    return restTemplate.getForObject(url, String.class);
  }
}
</code></pre>

        <h4>4. ìºì‹± ì „ëµ</h4>
        <pre><code class="language-java">@Cacheable(value = "externalAPICache", key = "#url")
public String getCachedAPIResponse(String url) {
  return callExternalAPI(url);
}

@CacheEvict(value = "externalAPICache", allEntries = true)
@Scheduled(fixedRate = 3600000)
public void clearCache() {
  log.info("ì™¸ë¶€ API ìºì‹œ ì§€ìš°ëŠ” ì¤‘");
}
</code></pre>
      </article>

      <article>
        <h3>ğŸ“Š ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼</h3>

        <h4>API ìƒíƒœ í™•ì¸</h4>
        <pre><code class="language-java">@Component
public class APIHealthIndicator implements HealthIndicator {

  private final SubscriptionService subscriptionService;
  private final GeocodingService geocodingService;
  private final NaverNewsAPI naverNewsAPI;

  @Override
  public Health health() {
    try {
      testLHAPI();
      testKakaoAPI();
      testNaverAPI();
      return Health.up().withDetail("apis", "ëª¨ë“  ì™¸ë¶€ APIê°€ ì •ìƒì…ë‹ˆë‹¤.").build();
    } catch (Exception e) {
      return Health.down().withDetail("error", e.getMessage()).build();
    }
  }

  private void testLHAPI() throws Exception { subscriptionService.updateSubAPT(); }
  private void testKakaoAPI() throws Exception { geocodingService.getCoordinates("ì„œìš¸ì‹œ ê°•ë‚¨êµ¬").block(); }
  private void testNaverAPI() throws Exception { naverNewsAPI.fetchNews("ë¶€ë™ì‚°", 1, 1); }
}
</code></pre>
      </article>

      <hr />
      <p><strong>ì™¸ë¶€ API ë¬¸ì„œ ë²„ì „</strong>: 1.0</p>
      <p><strong>ìµœì¢… ì—…ë°ì´íŠ¸</strong>: 2025-06-26</p>
      <p><strong>ì´ í†µí•©</strong>: 5ê°œ API</p>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <p>ìµœì¢… ì—…ë°ì´íŠ¸: 2025-06-26 | <a href="../index.html">ë¬¸ì„œ í™ˆìœ¼ë¡œ</a></p>
    </footer>
  </div>
</body>
</html>
